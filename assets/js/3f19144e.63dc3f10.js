"use strict";(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[3588],{6717:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"workflow/state-management","title":"State Management","description":"Aziron\'s workflow engine provides comprehensive state management capabilities to ensure reliable execution, recovery from failures, and persistence across system restarts.","source":"@site/docs/workflow/state-management.md","sourceDirName":"workflow","slug":"/workflow/state-management","permalink":"/aziron-docs/docs/workflow/state-management","draft":false,"unlisted":false,"editUrl":"https://github.com/MsysTechnologiesllc/Aziron/tree/main/wiki/docs/workflow/state-management.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Built-in Workflows","permalink":"/aziron-docs/docs/workflow/built-in-workflows"},"next":{"title":"Configuration Guide","permalink":"/aziron-docs/docs/workflow/configuration"}}');var r=t(4848),s=t(8453);const o={},c="State Management",l={},a=[{value:"Overview",id:"overview",level:2},{value:"Execution States",id:"execution-states",level:2},{value:"Workflow Execution States",id:"workflow-execution-states",level:3},{value:"Step Execution States",id:"step-execution-states",level:3},{value:"WorkflowExecution Structure",id:"workflowexecution-structure",level:2},{value:"Core Properties",id:"core-properties",level:3},{value:"Step Execution Details",id:"step-execution-details",level:3},{value:"Context Management",id:"context-management",level:2},{value:"Shared Context",id:"shared-context",level:3},{value:"Variable Scoping",id:"variable-scoping",level:3},{value:"Variable Substitution",id:"variable-substitution",level:3},{value:"Persistence",id:"persistence",level:2},{value:"Automatic Persistence",id:"automatic-persistence",level:3},{value:"Database Schema",id:"database-schema",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Checkpoints",id:"checkpoints",level:2},{value:"Automatic Checkpoints",id:"automatic-checkpoints",level:3},{value:"Checkpoint Types",id:"checkpoint-types",level:3},{value:"Creating Manual Checkpoints",id:"creating-manual-checkpoints",level:3},{value:"Recovery Mechanisms",id:"recovery-mechanisms",level:2},{value:"Automatic Recovery",id:"automatic-recovery",level:3},{value:"1. Step Retry",id:"1-step-retry",level:4},{value:"2. Workflow Resume",id:"2-workflow-resume",level:4},{value:"3. State Restoration",id:"3-state-restoration",level:4},{value:"Recovery Strategies",id:"recovery-strategies",level:3},{value:"Optimistic Recovery",id:"optimistic-recovery",level:4},{value:"Conservative Recovery",id:"conservative-recovery",level:4},{value:"Circuit Breaker",id:"circuit-breaker",level:4},{value:"History and Audit Trail",id:"history-and-audit-trail",level:2},{value:"Execution History",id:"execution-history",level:3},{value:"Step-Level Tracking",id:"step-level-tracking",level:3},{value:"Audit Events",id:"audit-events",level:3},{value:"Monitoring and Metrics",id:"monitoring-and-metrics",level:2},{value:"Real-time Monitoring",id:"real-time-monitoring",level:3},{value:"Performance Metrics",id:"performance-metrics",level:3},{value:"State Management API",id:"state-management-api",level:2},{value:"Query Execution State",id:"query-execution-state",level:3},{value:"Control Execution",id:"control-execution",level:3},{value:"Checkpoint Management",id:"checkpoint-management",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"State Design",id:"state-design",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Performance Optimization",id:"performance-optimization",level:3},{value:"Security Considerations",id:"security-considerations",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"State Corruption",id:"state-corruption",level:4},{value:"Recovery Failures",id:"recovery-failures",level:4},{value:"Performance Issues",id:"performance-issues",level:4},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"state-management",children:"State Management"})}),"\n",(0,r.jsx)(n.p,{children:"Aziron's workflow engine provides comprehensive state management capabilities to ensure reliable execution, recovery from failures, and persistence across system restarts."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The state management system handles:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Execution State"}),": Current workflow execution status and progress"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Context Persistence"}),": Workflow variables and intermediate results"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Recovery Mechanisms"}),": Resume workflows after failures or restarts"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"History Tracking"}),": Complete audit trail of workflow executions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Checkpoint Management"}),": Save and restore execution checkpoints"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"execution-states",children:"Execution States"}),"\n",(0,r.jsx)(n.h3,{id:"workflow-execution-states",children:"Workflow Execution States"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"State"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Transitions"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pending"})}),(0,r.jsx)(n.td,{children:"Workflow queued for execution"}),(0,r.jsxs)(n.td,{children:["\u2192 ",(0,r.jsx)(n.code,{children:"running"}),", ",(0,r.jsx)(n.code,{children:"cancelled"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"running"})}),(0,r.jsx)(n.td,{children:"Currently executing"}),(0,r.jsxs)(n.td,{children:["\u2192 ",(0,r.jsx)(n.code,{children:"completed"}),", ",(0,r.jsx)(n.code,{children:"failed"}),", ",(0,r.jsx)(n.code,{children:"paused"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"paused"})}),(0,r.jsx)(n.td,{children:"Temporarily suspended"}),(0,r.jsxs)(n.td,{children:["\u2192 ",(0,r.jsx)(n.code,{children:"running"}),", ",(0,r.jsx)(n.code,{children:"cancelled"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"completed"})}),(0,r.jsx)(n.td,{children:"Successfully finished"}),(0,r.jsx)(n.td,{children:"Terminal state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"failed"})}),(0,r.jsx)(n.td,{children:"Execution failed"}),(0,r.jsxs)(n.td,{children:["\u2192 ",(0,r.jsx)(n.code,{children:"retrying"}),", Terminal"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cancelled"})}),(0,r.jsx)(n.td,{children:"Manually cancelled"}),(0,r.jsx)(n.td,{children:"Terminal state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"retrying"})}),(0,r.jsx)(n.td,{children:"Attempting retry"}),(0,r.jsxs)(n.td,{children:["\u2192 ",(0,r.jsx)(n.code,{children:"running"}),", ",(0,r.jsx)(n.code,{children:"failed"})]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"step-execution-states",children:"Step Execution States"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"State"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Can Retry"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pending"})}),(0,r.jsx)(n.td,{children:"Waiting to execute"}),(0,r.jsx)(n.td,{children:"N/A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"running"})}),(0,r.jsx)(n.td,{children:"Currently executing"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"completed"})}),(0,r.jsx)(n.td,{children:"Successfully finished"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"failed"})}),(0,r.jsx)(n.td,{children:"Execution failed"}),(0,r.jsx)(n.td,{children:"Yes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"skipped"})}),(0,r.jsx)(n.td,{children:"Conditionally skipped"}),(0,r.jsx)(n.td,{children:"No"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"timeout"})}),(0,r.jsx)(n.td,{children:"Execution timed out"}),(0,r.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"workflowexecution-structure",children:"WorkflowExecution Structure"}),"\n",(0,r.jsx)(n.h3,{id:"core-properties",children:"Core Properties"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'type WorkflowExecution struct {\n    ID                string                    `json:"id"`\n    WorkflowID        string                    `json:"workflow_id"`\n    Status            WorkflowStatus            `json:"status"`\n    Context           map[string]interface{}    `json:"context"`\n    Results           map[string]interface{}    `json:"results"`\n    StepStates        map[string]StepExecution  `json:"step_states"`\n    OrchestrationData *OrchestrationContext     `json:"orchestration_data"`\n    StartedAt         time.Time                 `json:"started_at"`\n    CompletedAt       *time.Time                `json:"completed_at,omitempty"`\n    StartedBy         string                    `json:"started_by"`\n    Error             string                    `json:"error,omitempty"`\n    RetryCount        int                       `json:"retry_count"`\n    Checkpoints       []ExecutionCheckpoint     `json:"checkpoints"`\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"step-execution-details",children:"Step Execution Details"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'type StepExecution struct {\n    ID          string                 `json:"id"`\n    Status      StepStatus             `json:"status"`\n    StartedAt   *time.Time             `json:"started_at,omitempty"`\n    CompletedAt *time.Time             `json:"completed_at,omitempty"`\n    Duration    time.Duration          `json:"duration"`\n    Result      interface{}            `json:"result,omitempty"`\n    Error       string                 `json:"error,omitempty"`\n    RetryCount  int                    `json:"retry_count"`\n    Metadata    map[string]interface{} `json:"metadata,omitempty"`\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"context-management",children:"Context Management"}),"\n",(0,r.jsx)(n.h3,{id:"shared-context",children:"Shared Context"}),"\n",(0,r.jsx)(n.p,{children:"The shared context maintains state across the entire workflow execution:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "shared_context": {\n    "goal": "Process customer support ticket",\n    "user_instruction": "Analyze and respond to customer complaint",\n    "task_decomposition": [\n      {\n        "id": "analyze_sentiment",\n        "description": "Determine customer sentiment",\n        "status": "completed"\n      },\n      {\n        "id": "generate_response",\n        "description": "Create appropriate response",\n        "status": "running"\n      }\n    ],\n    "intermediate_results": {\n      "sentiment_score": 0.3,\n      "extracted_entities": ["billing", "refund", "frustration"],\n      "customer_tier": "premium"\n    },\n    "agent_invocations": [\n      {\n        "agent_id": "sentiment_analyzer",\n        "invoked_at": "2024-01-15T10:30:00Z",\n        "duration": 1200,\n        "success": true\n      }\n    ],\n    "facts_learned": {\n      "customer_id": "CUST-12345",\n      "account_status": "active",\n      "previous_tickets": 3\n    },\n    "session_id": "sess_abc123",\n    "current_phase": "response_generation"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"variable-scoping",children:"Variable Scoping"}),"\n",(0,r.jsx)(n.p,{children:"Variables in workflow context follow a scoping hierarchy:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Global Context"}),": Available to all steps"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Step Results"}),": Results from previous steps"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local Variables"}),": Step-specific variables"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"System Variables"}),": Built-in system values"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"variable-substitution",children:"Variable Substitution"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "content": "Hello {{user.name}}, your order {{order.id}} status is {{step_check_status_result.status}}"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Available Variables:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{{variable_name}}"})," - Global context variable"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{{step_<step_id>_result}}"})," - Result from specific step"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{{step_<step_id>_<property>}}"})," - Property from step result"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{{system.timestamp}}"})," - Current timestamp"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{{system.execution_id}}"})," - Current execution ID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{{system.workflow_id}}"})," - Current workflow ID"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"persistence",children:"Persistence"}),"\n",(0,r.jsx)(n.h3,{id:"automatic-persistence",children:"Automatic Persistence"}),"\n",(0,r.jsx)(n.p,{children:"The workflow engine automatically persists state at key points:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Workflow Start"}),": Initial state and context"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Step Completion"}),": Step results and updated context"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Step Failure"}),": Error information and retry state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Workflow Pause"}),": Complete execution state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Workflow Completion"}),": Final results and metrics"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"database-schema",children:"Database Schema"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Workflow executions table\nCREATE TABLE workflow_executions (\n    id UUID PRIMARY KEY,\n    workflow_id VARCHAR(255) NOT NULL,\n    status VARCHAR(50) NOT NULL,\n    context JSONB NOT NULL,\n    results JSONB,\n    started_at TIMESTAMP NOT NULL,\n    completed_at TIMESTAMP,\n    started_by VARCHAR(255) NOT NULL,\n    error TEXT,\n    retry_count INTEGER DEFAULT 0,\n    created_at TIMESTAMP DEFAULT NOW(),\n    updated_at TIMESTAMP DEFAULT NOW()\n);\n\n-- Step executions table\nCREATE TABLE step_executions (\n    id UUID PRIMARY KEY,\n    execution_id UUID REFERENCES workflow_executions(id),\n    step_id VARCHAR(255) NOT NULL,\n    status VARCHAR(50) NOT NULL,\n    started_at TIMESTAMP,\n    completed_at TIMESTAMP,\n    duration BIGINT, -- microseconds\n    result JSONB,\n    error TEXT,\n    retry_count INTEGER DEFAULT 0,\n    metadata JSONB\n);\n\n-- Execution checkpoints table\nCREATE TABLE execution_checkpoints (\n    id UUID PRIMARY KEY,\n    execution_id UUID REFERENCES workflow_executions(id),\n    checkpoint_name VARCHAR(255) NOT NULL,\n    state_data JSONB NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW()\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "persistence": {\n    "enabled": true,\n    "storage_backend": "postgresql",\n    "auto_save_interval": 30000,\n    "checkpoint_frequency": "per_step",\n    "retention_policy": {\n      "completed_executions": "30d",\n      "failed_executions": "90d",\n      "checkpoints": "7d"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"checkpoints",children:"Checkpoints"}),"\n",(0,r.jsx)(n.h3,{id:"automatic-checkpoints",children:"Automatic Checkpoints"}),"\n",(0,r.jsx)(n.p,{children:"The system automatically creates checkpoints at strategic points:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'type ExecutionCheckpoint struct {\n    ID             string                 `json:"id"`\n    ExecutionID    string                 `json:"execution_id"`\n    CheckpointName string                 `json:"checkpoint_name"`\n    StateData      map[string]interface{} `json:"state_data"`\n    CreatedAt      time.Time              `json:"created_at"`\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"checkpoint-types",children:"Checkpoint Types"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"step_start"})}),": Before step execution begins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"step_complete"})}),": After successful step completion"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"branch_split"})}),": Before parallel execution split"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"branch_merge"})}),": After parallel execution merge"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"error_recovery"})}),": Before error recovery attempt"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"manual"})}),": User-triggered checkpoint"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"creating-manual-checkpoints",children:"Creating Manual Checkpoints"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "id": "create_checkpoint",\n  "type": "checkpoint",\n  "config": {\n    "checkpoint_name": "before_expensive_operation",\n    "include_context": true,\n    "include_results": true\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"recovery-mechanisms",children:"Recovery Mechanisms"}),"\n",(0,r.jsx)(n.h3,{id:"automatic-recovery",children:"Automatic Recovery"}),"\n",(0,r.jsx)(n.p,{children:"The workflow engine provides several recovery mechanisms:"}),"\n",(0,r.jsx)(n.h4,{id:"1-step-retry",children:"1. Step Retry"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "id": "resilient_step",\n  "type": "message",\n  "config": {\n    "retry_policy": {\n      "max_retries": 3,\n      "retry_delay": 1000,\n      "backoff_multiplier": 2.0,\n      "retry_on": ["timeout", "network_error", "rate_limit"]\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-workflow-resume",children:"2. Workflow Resume"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// Resume workflow from last checkpoint\nexecution, err := workflowEngine.ResumeExecution(executionID)\nif err != nil {\n    log.Printf("Failed to resume execution: %v", err)\n    return err\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"3-state-restoration",children:"3. State Restoration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// Restore execution state from checkpoint\nerr := workflowEngine.RestoreFromCheckpoint(executionID, checkpointName)\nif err != nil {\n    log.Printf("Failed to restore from checkpoint: %v", err)\n    return err\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"recovery-strategies",children:"Recovery Strategies"}),"\n",(0,r.jsx)(n.h4,{id:"optimistic-recovery",children:"Optimistic Recovery"}),"\n",(0,r.jsx)(n.p,{children:"Assume the system can recover and continue execution:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "recovery_strategy": "optimistic",\n  "max_recovery_attempts": 3,\n  "recovery_timeout": 30000\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"conservative-recovery",children:"Conservative Recovery"}),"\n",(0,r.jsx)(n.p,{children:"Require manual intervention for complex failures:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "recovery_strategy": "conservative",\n  "require_manual_approval": true,\n  "notify_on_failure": ["admin@company.com"]\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"circuit-breaker",children:"Circuit Breaker"}),"\n",(0,r.jsx)(n.p,{children:"Prevent cascading failures:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "circuit_breaker": {\n    "failure_threshold": 5,\n    "timeout": 60000,\n    "half_open_requests": 3\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"history-and-audit-trail",children:"History and Audit Trail"}),"\n",(0,r.jsx)(n.h3,{id:"execution-history",children:"Execution History"}),"\n",(0,r.jsx)(n.p,{children:"Complete history of workflow executions is maintained:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "execution_history": [\n    {\n      "execution_id": "exec_123",\n      "workflow_id": "email_processor",\n      "started_at": "2024-01-15T10:00:00Z",\n      "completed_at": "2024-01-15T10:05:30Z",\n      "status": "completed",\n      "duration": 330000,\n      "steps_executed": 8,\n      "steps_failed": 0,\n      "started_by": "user@company.com"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"step-level-tracking",children:"Step-Level Tracking"}),"\n",(0,r.jsx)(n.p,{children:"Detailed tracking for each step execution:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "step_history": [\n    {\n      "step_id": "parse_email",\n      "execution_id": "exec_123",\n      "started_at": "2024-01-15T10:00:01Z",\n      "completed_at": "2024-01-15T10:00:03Z",\n      "duration": 2000,\n      "status": "completed",\n      "input_size": 1024,\n      "output_size": 512,\n      "agent_used": "email_parser"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"audit-events",children:"Audit Events"}),"\n",(0,r.jsx)(n.p,{children:"Security and compliance audit events:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "audit_events": [\n    {\n      "event_type": "workflow_started",\n      "execution_id": "exec_123",\n      "user_id": "user@company.com",\n      "timestamp": "2024-01-15T10:00:00Z",\n      "metadata": {\n        "workflow_id": "email_processor",\n        "source_ip": "192.168.1.100"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"monitoring-and-metrics",children:"Monitoring and Metrics"}),"\n",(0,r.jsx)(n.h3,{id:"real-time-monitoring",children:"Real-time Monitoring"}),"\n",(0,r.jsx)(n.p,{children:"Monitor workflow execution in real-time:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Get current execution status\ncurl -X GET http://localhost:8080/api/v1/workflows/executions/exec_123/status \\\n  -H "Authorization: Bearer YOUR_TOKEN"\n\n# Get step-by-step progress\ncurl -X GET http://localhost:8080/api/v1/workflows/executions/exec_123/steps \\\n  -H "Authorization: Bearer YOUR_TOKEN"\n\n# Stream execution events\ncurl -X GET http://localhost:8080/api/v1/workflows/executions/exec_123/stream \\\n  -H "Authorization: Bearer YOUR_TOKEN"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"performance-metrics",children:"Performance Metrics"}),"\n",(0,r.jsx)(n.p,{children:"Track workflow performance:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "performance_metrics": {\n    "average_execution_time": 45000,\n    "success_rate": 0.97,\n    "error_rate": 0.03,\n    "retry_rate": 0.12,\n    "resource_utilization": {\n      "cpu_avg": 0.35,\n      "memory_avg": "256MB",\n      "network_io": "125KB/s"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"state-management-api",children:"State Management API"}),"\n",(0,r.jsx)(n.h3,{id:"query-execution-state",children:"Query Execution State"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Get execution details\nGET /api/v1/workflows/executions/{execution_id}\n\n# Get step states\nGET /api/v1/workflows/executions/{execution_id}/steps\n\n# Get execution context\nGET /api/v1/workflows/executions/{execution_id}/context\n\n# Get checkpoints\nGET /api/v1/workflows/executions/{execution_id}/checkpoints\n"})}),"\n",(0,r.jsx)(n.h3,{id:"control-execution",children:"Control Execution"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Pause execution\nPOST /api/v1/workflows/executions/{execution_id}/pause\n\n# Resume execution\nPOST /api/v1/workflows/executions/{execution_id}/resume\n\n# Cancel execution\nPOST /api/v1/workflows/executions/{execution_id}/cancel\n\n# Retry failed steps\nPOST /api/v1/workflows/executions/{execution_id}/retry\n"})}),"\n",(0,r.jsx)(n.h3,{id:"checkpoint-management",children:"Checkpoint Management"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Create checkpoint\nPOST /api/v1/workflows/executions/{execution_id}/checkpoints\n{\n  "name": "before_critical_operation",\n  "description": "Checkpoint before data migration"\n}\n\n# Restore from checkpoint\nPOST /api/v1/workflows/executions/{execution_id}/restore\n{\n  "checkpoint_name": "before_critical_operation"\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"state-design",children:"State Design"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep Context Minimal"}),": Only store necessary data in context"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Immutable Data"}),": Avoid modifying shared context directly"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Clear Variable Names"}),": Use descriptive names for context variables"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Version Context"}),": Include version information for context evolution"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Graceful Degradation"}),": Design workflows to handle partial failures"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Meaningful Errors"}),": Provide clear error messages and recovery hints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Classification"}),": Categorize errors for appropriate handling"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Recovery Testing"}),": Test recovery mechanisms regularly"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Checkpoint Frequency"}),": Balance between recovery speed and overhead"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Context Size"}),": Monitor and limit context size growth"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleanup Policies"}),": Implement appropriate data retention policies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resource Monitoring"}),": Monitor state storage resource usage"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sensitive Data"}),": Encrypt sensitive data in persistent state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access Control"}),": Implement proper access controls for state data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit Logging"}),": Log all state access and modifications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Data Retention"}),": Follow compliance requirements for data retention"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsx)(n.h4,{id:"state-corruption",children:"State Corruption"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Validate execution state\ncurl -X POST http://localhost:8080/api/v1/workflows/executions/exec_123/validate\n\n# Repair corrupted state\ncurl -X POST http://localhost:8080/api/v1/workflows/executions/exec_123/repair\n"})}),"\n",(0,r.jsx)(n.h4,{id:"recovery-failures",children:"Recovery Failures"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Get recovery status\ncurl -X GET http://localhost:8080/api/v1/workflows/executions/exec_123/recovery\n\n# Force recovery\ncurl -X POST http://localhost:8080/api/v1/workflows/executions/exec_123/force-recovery\n"})}),"\n",(0,r.jsx)(n.h4,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Get state metrics\ncurl -X GET http://localhost:8080/api/v1/workflows/metrics/state\n\n# Analyze execution bottlenecks\ncurl -X GET http://localhost:8080/api/v1/workflows/executions/exec_123/analyze\n"})}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"./advanced-patterns",children:"Advanced Patterns"})})," - Complex workflow patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"./performance-tuning",children:"Performance Tuning"})})," - Optimize workflow performance"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"./security",children:"Security Best Practices"})})," - Secure workflow design"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"./monitoring",children:"Monitoring and Observability"})})," - Production monitoring"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var i=t(6540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);